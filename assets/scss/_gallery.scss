@import "variables";

// Mixin to handle prefixes efficiently
@mixin column-count($count) {
  -webkit-column-count: $count;
  -moz-column-count: $count;
  column-count: $count;
}

// Gallery Base
.gal {
    position: relative;
  // Default behavior (3 columns)
    @include column-count(3);

    @for $num from 1 through 5 
    {
        &.column-#{$num} 
        { // This correctly targets .gal.gal-1, .gal.gal-2, etc.
            @include column-count($num);
        }
    }

    // Loop to generate .gal-1 through .gal-5
    @each $breakpoint, $min-width in $grid-breakpoints 
    {
        @media (min-width: #{$min-width}) 
        {
            @for $num from 1 through 5 
            {
                &.column-#{$breakpoint}-#{$num} 
                { // This correctly targets .gal.gal-1, .gal.gal-2, etc.
                    @include column-count($num);
                }
            }
        }
    }
    // --- Styles for internal elements ---
    img, canvas { 
        transition: color .15s ease-in-out, background-color .15s ease-in-out, outline .3s ease-in-out, transform .05s ease-in-out;
        outline: rgba(255, 255, 255, 0) solid 0px ;
        width: 100%; 
        object-fit: cover;
        filter: drop-shadow(0 3mm 4mm rgba(31, 31, 31, 0.8));
    }

    .corner, .bottom {
        display: none;
        user-select: none;
        margin: 0;
        padding: 0 4%;
        box-shadow: inset 4px 4px white, inset -4px -4px white;
        background-color: white;
        color: darkgrey;
    }

    .corner { font-size: 12px; z-index: 1000; }
    .bottom { font-size: 14px; z-index: 510; }

    .gal-wrap {
        position: relative;
        &:hover {
        img, canvas {
            transform: scale(1.1);
            outline: white solid 4px;
            z-index: 500;
        }
        .corner { 
            text-shadow: none;
            display: inline-block;
            position: absolute;
            top: 8px;
            left: 0px;
        }
        .bottom {
            text-shadow: none;
            display: inline-block;
            position: absolute;
            bottom: 8px;
            right: 0px;
        }
        }
    }
}

.gal-carousel {
    .carousel-inner {
        overflow: visible; 
    }
    .gal-carousel-dummy {
    aspect-ratio: 1 / 1; // Match the aspect ratio of your real items
    pointer-events: none; // Ensure users can't click/hover "nothing"
}

    .gal-carousel-wrap {
        position: relative;

        canvas, img {
            width: 100%;
            display: block;
            object-fit: cover;
            
            // Desktop: Square
            aspect-ratio: 1 / 1; 
            
            // Mobile: Wider rectangle so the stack doesn't get too long
            @media (max-width: 768px) {
                aspect-ratio: 16 / 9;
            }
            outline: rgba(255, 255, 255, 0) solid 0px ;
            transition: transform 0.2s ease-in-out, outline 0.3s ease-in-out;
            filter: drop-shadow(0 2mm 3mm rgba(0, 0, 0, 0.3));
        }
                // Shared Label Styles
        .gal-label-corner, 
        .gal-label-bottom {
            display: none;
            user-select: none;
            font-size: 12px;
            padding: 2px 8px;
            background-color: white;
            color: darkgrey;
            box-shadow: inset 2px 2px white, inset -2px -2px white;
            z-index: 1000;
            position: absolute;
        }

        &:hover {
            z-index: 500;
            @media (min-width: 769px) { // Only scale on desktop
                canvas, img {
                    transform: scale(1.05);
                    outline: white solid 4px;
                }
            }
            .gal-label-corner {
                display: inline-block;
                top: 8px;
                left: -4px; // Slight offset for visual pop
            }

            .gal-label-bottom {
                display: inline-block;
                bottom: 8px;
                right: -4px;
                font-size: 14px;
            }
        }
    }
    // Adjust arrow visibility/styling
    .carousel-control-prev, .carousel-control-next {
        width: 40px;
        opacity: 0.8;
        z-index: 2000;
        &:hover { opacity: 1; }
        .carousel-control-prev-icon, .carousel-control-next-icon {
            filter: invert(1);
        }
    }
}

.gal-row {
    display: flex;
    flex-wrap: wrap;
    gap: 10px; // Space between items
    
    .gal-item 
    {
        height: 140px;
        @media (min-width: 768px) 
        { 
            height: 230px;
        }
    }

    .gal-wrap {
        
        canvas, img {
            flex: 0 0;
            width: auto;      // Width scales based on aspect ratio
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease, outline 0.2s ease;
        }
        .corner, .bottom {
        display: none;
        user-select: none;
        margin: 0;
        padding: 0 4%;
        box-shadow: inset 4px 4px white, inset -4px -4px white;
        background-color: white;
        color: darkgrey;
        }

        &:hover {
            canvas, img {
                transform: scale(1.05);
                outline: white solid 4px;
                z-index: 10;
            }
            .corner, .bottom {
                display: inline-block;
                position: absolute;
                background: white;
                color: #333;
                padding: 2px 8px;
                z-index: 20;
            }
            .corner { top: 10px; left: 0; font-size: 12px; }
            .bottom { bottom: 10px; right: 0; font-size: 14px; }
        }
    }
}